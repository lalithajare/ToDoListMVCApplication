# Android

# Build your Android project with Gradle.
# Add steps that test, sign, and distribute the APK, save build artifacts, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/android
#latest

trigger:
- master

pool:
  vmImage: 'macos-latest'

steps:
- task: Gradle@2
  inputs:
    workingDirectory: ''
    gradleWrapperFile: 'gradlew'
    gradleOptions: '-Xmx3072m'
    publishJUnitResults: false
    testResultsFiles: '**/TEST-*.xml'
    tasks: 'assembleDebug'



# - script: bash xccov-to-sonarqube-generic.sh Build/Logs/Test/{testpass}.xcresult/{#}_Test/action.xcovreport/*.xccovarchive/ > sonarqube-generic-coverage.xml


- task: SonarCloudPrepare@1
  inputs:
    SonarCloud: 'sonar'
    organization: 'lalit'
    scannerMode: 'CLI'
    configMode: 'manual'
    cliProjectKey: 'ToDoApp'
    cliProjectName: 'ToDoApp'
    cliSources: '$(system.defaultworkingdirectory)'
    extraProperties: 
       'sonar.organization=lalit,
        sonar.sources=java,
        sonar.branch.name=master,
        sonar.branch.target=master,
        sonar.projectVersion=1.0,
        sonar.java.coverage.reportPath=Coverage.report,
        sonar.java.coverage.reportPattern=sonar-reports/coverage*.xml'

- task: SonarCloudAnalyze@1

- task: SonarCloudPublish@1
  inputs:
    pollingTimeoutSec: '300'


